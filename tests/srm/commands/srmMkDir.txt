*** Settings ***

Resource   lib/stormlib.txt
Resource   lib/clientSRM.txt
Resource   lib/setup.txt

*** Test Cases ***

Create new empty directory
  [Tags]  storm-client  mkdir
  [Setup]  Use default voms proxy
  ${dirname}  Get a unique name
  ${surl}  Build surl  ${DEFAULT_SA}  ${TESTDIR}/${dirname}
  ${output}  Perform mkdir using clientSRM  ${surl}
  Should Contain  ${output}  SRM_SUCCESS
  ${output}  Perform rmdir using clientSRM  ${surl}
  Should Contain  ${output}  SRM_SUCCESS
  [Teardown]  Clear all credentials

Create directory with invalid path
  [Tags]  storm-client  mkdir
  [Setup]  Use default voms proxy
  ${dirname}  Get a unique name
  ${surl}  Build surl  fakeVO  ${dirname}
  ${output}  Perform mkdir using clientSRM  ${surl}
  Should Contain  ${output}  SRM_INVALID_PATH
  [Teardown]  Clear all credentials

Create directory that already exists
  [Tags]  storm-client  mkdir
  [Setup]  Use default voms proxy
  ${dirname}  Get a unique name
  ${surl}  Build surl  ${DEFAULT_SA}  ${TESTDIR}/${dirname}
  ${output}  Perform mkdir using clientSRM  ${surl}
  Should Contain  ${output}  SRM_SUCCESS
  ${output}  Perform mkdir using clientSRM  ${surl}
  Should Contain  ${output}  SRM_DUPLICATION_ERROR
  Should Contain  ${output}  Directory specified exists!
  ${output}  Perform rmdir using clientSRM  ${surl}
  Should Contain  ${output}  SRM_SUCCESS
  [Teardown]  Clear all credentials

Create directory with unauthorized credentials
  [Tags]  storm-client  mkdir
  [Setup]  Use default grid proxy
  ${dirname}  Get a unique name
  ${surl}  Build surl  ${DEFAULT_SA}  ${TESTDIR}/${dirname}
  ${output}  Perform mkdir using clientSRM  ${surl}
  Should Contain  ${output}  SRM_AUTHORIZATION_FAILURE
  [Teardown]  Clear all credentials

Check directory creation on a different VO
  [Tags]  storm-client  ls  STOR-898
  [Setup]  Use default voms proxy
  ${dirname}  Get a unique name
  ${qsurl}  Build surl  ${SA.2}  ../${DEFAULT_SA}/${TESTDIR}/${dirname}
  ${output}  Perform mkdir using clientSRM  ${qsurl}
  Should Contain  ${output}  SRM_AUTHORIZATION_FAILURE
  ${qsurl}  Build surl  ${DEFAULT_SA}  ../${SA.2}/${TESTDIR}/${dirname}
  ${output}  Perform mkdir using clientSRM  ${qsurl}
  Should Contain  ${output}  SRM_AUTHORIZATION_FAILURE
  [Teardown]  Clear all credentials
