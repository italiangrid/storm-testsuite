*** Settings ***

Resource   lib/stormlib.txt
Resource   lib/credentials.txt
Resource   lib/webdav.txt

Suite Setup       Setup tests
Suite Teardown    Teardown tests

*** Keywords ***

Init local working directory
  Remove local directory  ${TESTDIR}
  Create local directory  ${TESTDIR}
  Execute and Check Success  cp ${TESTERS_CERT_SRC} ${TESTERS_CERT}
  Init certificate and plain proxy  test0
  Execute and Check Success  cp ${userproxy} ${GRID_PROXY}
  Init certificate and voms proxy  test0  ${vo}
  Execute and Check Success  cp ${userproxy} ${VOMS_PROXY}
  Clear all credentials

Clear remote working directories
  ${plainproxy}  Get WebDAV plain proxy credentials
  ${vomsproxy}  Get WebDAV VOMS proxy credentials
  ${output}  WebDAV DELETE  ${davEndpoint}  ${ANONYMOUS_SA}  ${TESTDIR}
  Log  ${output}
  ${output}  WebDAV DELETE  ${davSecureEndpoint}  ${PLAINPROXY_SA}  ${TESTDIR}  ${plainproxy}
  Log  ${output}
  ${output}  WebDAV DELETE  ${davSecureEndpoint}  ${VOMSPROXY_SA}  ${TESTDIR}  ${vomsproxy}
  Log  ${output}
  ${output}  WebDAV DELETE  ${davSecureEndpoint}  ${NESTED_SA}  ${TESTDIR}  ${vomsproxy}
  Log  ${output}

Init remote working directories
  ${plainproxy}  Get WebDAV plain proxy credentials
  ${vomsproxy}  Get WebDAV VOMS proxy credentials
  ${output}  WebDAV MKCOL  ${davEndpoint}  ${ANONYMOUS_SA}  ${TESTDIR}
  Log  ${output}
  Should Contain  ${output}  201 Created
  ${output}  WebDAV MKCOL  ${davSecureEndpoint}  ${PLAINPROXY_SA}  ${TESTDIR}  ${plainproxy}
  Log  ${output}
  Should Contain  ${output}  201 Created
  ${output}  WebDAV MKCOL  ${davSecureEndpoint}  ${VOMSPROXY_SA}  ${TESTDIR}  ${vomsproxy}
  Log  ${output}
  Should Contain  ${output}  201 Created
  ${output}  WebDAV MKCOL  ${davSecureEndpoint}  ${NESTED_SA}  ${TESTDIR}  ${vomsproxy}
  Log  ${output}
  Should Contain  ${output}  201 Created

Setup tests
  Init local working directory
  Clear remote working directories
  Init remote working directories

Teardown tests
  Clear remote working directories
  Remove local directory  ${TESTDIR}

