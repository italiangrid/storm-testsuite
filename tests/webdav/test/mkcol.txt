*** Settings ***

Resource   lib/webdav.txt
Resource   lib/clientSRM.txt
Resource   lib/credentials.txt

*** Test Cases ***

######### ANONYMOUS ##########

WebDAV MKCOL as anonymous
  [Tags]  webdav  mkcol  anonymous
  ${dirname}  Get a unique name
  ${url}  Build webdav unsecure URL  ${ANONYMOUS_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV anonymous MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  201 Created

WebDAV MKCOL with missing parent as anonymous
  [Tags]  webdav  mkcol  anonymous
  ${url}  Build webdav unsecure URL  ${ANONYMOUS_SA}  ${TESTDIR}/fakedirectory/fakedirname
  ${output}  WebDAV anonymous MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  409 Conflict

WebDAV MKCOL over existent directory as anonymous
  [Tags]  webdav  mkcol  anonymous
  ${dirname}  Get a unique name
  ${url}  Build webdav unsecure URL  ${ANONYMOUS_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV anonymous MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  201 Created
  ${output}  WebDAV anonymous MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  405 Method Not Allowed

WebDAV MKCOL as anonymous on unwriteable storage area
  [Tags]  webdav  mkcol  anonymous
  ${dirname}  Get a unique name
  ${url}  Build webdav unsecure URL  ${VOMSPROXY_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV anonymous MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  403

####### VOMS PROXY #########

WebDAV MKCOL with VOMS proxy
  [Tags]  webdav  mkcol  vomsproxy
  ${dirname}  Get a unique name
  ${url}  Build webdav secure URL  ${VOMSPROXY_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV voms proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  201 Created

WebDAV MKCOL with missing parent with VOMS proxy
  [Tags]  webdav  mkcol  vomsproxy
  ${url}  Build webdav secure URL  ${VOMSPROXY_SA}  ${TESTDIR}/fakedirectory/fakedirname
  ${output}  WebDAV voms proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  409 Conflict

WebDAV MKCOL over existent directory with VOMS proxy
  [Tags]  webdav  mkcol  vomsproxy
  ${dirname}  Get a unique name
  ${url}  Build webdav secure URL  ${VOMSPROXY_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV voms proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  201 Created
  ${output}  WebDAV voms proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  405 Method Not Allowed

WebDAV MKCOL with VOMS proxy on an anonymous writeable storage area
  [Tags]  webdav  mkcol  vomsproxy
  ${dirname}  Get a unique name
  ${url}  Build webdav secure URL  ${ANONYMOUS_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV voms proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  201 Created

######### PLAIN PROXY ##########

WebDAV MKCOL with plain proxy
  [Tags]  webdav  mkcol  plainproxy
  ${dirname}  Get a unique name
  ${url}  Build webdav secure URL  ${PLAINPROXY_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV plain proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  201 Created

WebDAV MKCOL with missing parent with plain proxy
  [Tags]  webdav  mkcol  plainproxy
  ${url}  Build webdav secure URL  ${PLAINPROXY_SA}  ${TESTDIR}/fakedirectory/fakedirname
  ${output}  WebDAV plain proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  409 Conflict

WebDAV MKCOL over existent directory with plain proxy
  [Tags]  webdav  mkcol  plainproxy
  ${dirname}  Get a unique name
  ${url}  Build webdav secure URL  ${PLAINPROXY_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV plain proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  201 Created
  ${output}  WebDAV plain proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  405 Method Not Allowed

WebDAV MKCOL with plain proxy on an anonymous writeable storage area
  [Tags]  webdav  mkcol  plainproxy
  ${dirname}  Get a unique name
  ${url}  Build webdav secure URL  ${ANONYMOUS_SA}  ${TESTDIR}/${dirname}
  ${output}  WebDAV plain proxy MKCOL  ${url}
  Log  ${output}
  Should Contain  ${output}  201 Created
